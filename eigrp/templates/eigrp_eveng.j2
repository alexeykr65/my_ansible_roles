#jinja2: trim_blocks: True, lstrip_blocks: True
{# Configure EIGRP for IOS #}
{# ====================Configure EIGRP ================================== #}
{% for eg in eigrp %}
router eigrp {{eg.eigrp_name}}
{# ==================== Address Family ================================== #}
 address-family ipv4 unicast autonomous-system {{ eg.address_family }}
  {% if  'router_id' in eg %}
  eigrp router-id {{ eg.router_id }}
  {% endif %}
{# ==================== Networks ================================== #}
  {% for net in eg.networks %}
  network {{ net['net'] | ipaddr('network') }} {{ net['net'] | ipaddr('hostmask') }}
  {% endfor %}
{# ==================== Stub Site Num ================================== #}
  {% if  'stub_site' in eg %}
  eigrp stub connected summary
  {% endif %}
{# ==================== Distribute List ================================== #}
  {% if  'distribute' in eg %}
  topology base
  {% for net in eg.distribute %}
   distribute-list route-map {{ net.dis_name }} {{ net.direction }}
  {% endfor %}
   exit
  {% endif %}
  {% if  'redistribute' in eg %}
  topology base
  {% for red in eg.redistribute %}
   redistribute {{ red }}
  {% endfor %}
   exit
  {% endif %}

{# ==================== AF Interfaces ================================== #}
  {% if  'af_int' in eg %}
     {% for af_int in eg.af_int %}
  af-interface {{ af_int.int_name }}
       {% if  'hello_interval' in af_int %}
   hello-interval {{ af_int.hello_interval }}
       {% endif %}
       {% if  'hold_time' in af_int %}
   hold-time {{ af_int.hold_time }}
       {% endif %}
       {% if  'split_horizon' in af_int %}
   no split-horizon
       {% endif %}
       {% if  'passive_int' in af_int %}
         {% if  af_int.passive_int %}
   passive-interface
         {% else %}
   no passive-interface
         {% endif %}
       {% endif %}
  {# ==================== Stub WAN (AF Interfaces) ================================== #}
       {% if  'stub_int' in af_int %}
   !stub-site wan-interface
       {% endif %}
  {# ==================== Summary address ================================== #}
       {% if  'summary_address' in af_int %}
         {% for summ in af_int.summary_address %}
   summary-address {{ summ | ipaddr('network') }} {{ summ | ipaddr('netmask') }}
         {% endfor %}
       {% endif %}
{# ==================== Exit AF Interfaces ================================== #}
   exit
     {% endfor %}
   {% endif %}
{# ==================== Configure Delay on Interfaces ======================== #}
{% endfor %}

